<%- include('../partials/head.ejs') %>

    <body>
        <div>
            <h1>Welcome to bezsciemy protected page!</h1>
        </div>
        <button id="logout-btn">Logout</button>
    </body>

    </html>

    <script>
        window.addEventListener("load", () => {
            function logout() {
                const request = new XMLHttpRequest();

                request.addEventListener("load", (event) => {
                    const response = JSON.parse(event.target.responseText);
                    if (response.redirect) {
                        window.location.href = response.redirect;
                    }
                });

                request.addEventListener("error", (event) => {
                    console.log("An error occured.");
                });

                request.open("POST", "http://localhost:3000/logout", true);
                request.send();
            }
            const logoutBtn = document.getElementById('logout-btn')
            logoutBtn.addEventListener("click", (event) => {
                event.preventDefault();
                console.log(logoutBtn);
                logout();
            });
        });
    </script>